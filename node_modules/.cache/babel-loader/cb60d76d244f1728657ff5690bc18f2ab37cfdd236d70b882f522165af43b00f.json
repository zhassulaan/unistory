{"ast":null,"code":"import _regeneratorRuntime from\"/Users/zhassik/Desktop/unistory/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/zhassik/Desktop/unistory/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/zhassik/Desktop/unistory/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{BrowserRouter as Router,Routes,Route}from\"react-router-dom\";import Home from\"./pages/HomePage\";import User from\"./pages/UserPage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var getLocalItem=function getLocalItem(){var user=localStorage.getItem('user');if(user){return JSON.parse(localStorage.getItem('user')||'{}');}else{return['','',''];}};function App(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),defaultAccount=_useState2[0],setDefaultAccount=_useState2[1];var user=getLocalItem();window.onload=function(event){isConnected();};function isConnected(){return _isConnected.apply(this,arguments);}function _isConnected(){_isConnected=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var accounts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return window.ethereum.request({method:'eth_accounts'});case 2:accounts=_context.sent;if(accounts.length){setDefaultAccount(accounts[0]);console.log(\"You're connected to: \".concat(accounts[0]));}else{console.log(\"Metamask is not connected\");}case 4:case\"end\":return _context.stop();}},_callee);}));return _isConnected.apply(this,arguments);}var connectWalletHandler=function connectWalletHandler(){if(window.ethereum){// if metamask exists\nwindow.ethereum.request({method:'eth_requestAccounts'}).then(function(result){accountChangedHandler(result[0]);});}else{console.log('Please, install MetaMask');}};var accountChangedHandler=function accountChangedHandler(newAccount){setDefaultAccount(newAccount);};return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{account:defaultAccount,connect:connectWalletHandler,user:user})}),/*#__PURE__*/_jsx(Route,{path:\"/user\",element:/*#__PURE__*/_jsx(User,{account:defaultAccount,connect:connectWalletHandler,user:user})})]})})});}export default App;","map":{"version":3,"names":["React","useState","BrowserRouter","Router","Routes","Route","Home","User","getLocalItem","user","localStorage","getItem","JSON","parse","App","defaultAccount","setDefaultAccount","window","onload","event","isConnected","ethereum","request","method","accounts","length","console","log","connectWalletHandler","then","result","accountChangedHandler","newAccount"],"sources":["/Users/zhassik/Desktop/unistory/src/App.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { BrowserRouter as Router, Routes, Route } from \"react-router-dom\";\nimport Home from \"./pages/HomePage\";\nimport User from \"./pages/UserPage\";\n\nconst getLocalItem = () => {\n\tlet user = localStorage.getItem('user');\n\n\tif (user) {\n\t\treturn JSON.parse(localStorage.getItem('user') || '{}');\n\t} else {\n\t\treturn ['', '', ''];\n\t}\n}\n\nfunction App() {\n\tconst [defaultAccount, setDefaultAccount] = useState(null);\n\tconst user: string[] = getLocalItem();\n\n\twindow.onload = (event) => {\n\t\tisConnected();\n\t};\n\t\t\t \n\tasync function isConnected() {\n\t\tconst accounts = await window.ethereum.request({method: 'eth_accounts'});       \n\t\tif (accounts.length) {\n\t\t\tsetDefaultAccount(accounts[0])\n\t\t\tconsole.log(`You're connected to: ${accounts[0]}`);\n\t\t} else {\n\t\t\tconsole.log(\"Metamask is not connected\");\n\t\t}\n\t}\n\n\tconst connectWalletHandler = () => {\n\t\tif (window.ethereum) {\n\t\t\t// if metamask exists\n\t\t\twindow.ethereum.request({ method: 'eth_requestAccounts'})\n\t\t\t.then((result: any) => {\n\t\t\t\taccountChangedHandler(result[0]);\n\t\t\t})\n\t\t} else {\n\t\t\tconsole.log('Please, install MetaMask');\n\t\t}\n\t}\n\n\tconst accountChangedHandler = (newAccount: any) => {\n\t\tsetDefaultAccount(newAccount);\n\t}\n\n  return (\n    <div className=\"App\">\n\t\t<Router>\n\t\t\t<Routes>\n\t\t\t\t<Route path=\"/\" element={ <Home account={ defaultAccount } connect={ connectWalletHandler } user={ user } /> } />\n\t\t\t\t<Route path=\"/user\" element={ <User account={ defaultAccount } connect={ connectWalletHandler } user={ user } /> } />\n\t\t\t</Routes>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"+WAAA,MAAOA,MAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,aAAa,GAAIC,OAAM,CAAEC,MAAM,CAAEC,KAAK,KAAQ,kBAAkB,CACzE,MAAOC,KAAI,KAAM,kBAAkB,CACnC,MAAOC,KAAI,KAAM,kBAAkB,CAAC,wFAEpC,GAAMC,aAAY,CAAG,QAAfA,aAAY,EAAS,CAC1B,GAAIC,KAAI,CAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAEvC,GAAIF,IAAI,CAAE,CACT,MAAOG,KAAI,CAACC,KAAK,CAACH,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,EAAI,IAAI,CAAC,CACxD,CAAC,IAAM,CACN,MAAO,CAAC,EAAE,CAAE,EAAE,CAAE,EAAE,CAAC,CACpB,CACD,CAAC,CAED,QAASG,IAAG,EAAG,CACd,cAA4Cb,QAAQ,CAAC,IAAI,CAAC,wCAAnDc,cAAc,eAAEC,iBAAiB,eACxC,GAAMP,KAAc,CAAGD,YAAY,EAAE,CAErCS,MAAM,CAACC,MAAM,CAAG,SAACC,KAAK,CAAK,CAC1BC,WAAW,EAAE,CACd,CAAC,CAAC,QAEaA,YAAW,6IAA1B,uKACwBH,OAAM,CAACI,QAAQ,CAACC,OAAO,CAAC,CAACC,MAAM,CAAE,cAAc,CAAC,CAAC,QAAlEC,QAAQ,eACd,GAAIA,QAAQ,CAACC,MAAM,CAAE,CACpBT,iBAAiB,CAACQ,QAAQ,CAAC,CAAC,CAAC,CAAC,CAC9BE,OAAO,CAACC,GAAG,gCAAyBH,QAAQ,CAAC,CAAC,CAAC,EAAG,CACnD,CAAC,IAAM,CACNE,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC,CACzC,CAAC,qDACD,8CAED,GAAMC,qBAAoB,CAAG,QAAvBA,qBAAoB,EAAS,CAClC,GAAIX,MAAM,CAACI,QAAQ,CAAE,CACpB;AACAJ,MAAM,CAACI,QAAQ,CAACC,OAAO,CAAC,CAAEC,MAAM,CAAE,qBAAqB,CAAC,CAAC,CACxDM,IAAI,CAAC,SAACC,MAAW,CAAK,CACtBC,qBAAqB,CAACD,MAAM,CAAC,CAAC,CAAC,CAAC,CACjC,CAAC,CAAC,CACH,CAAC,IAAM,CACNJ,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC,CACxC,CACD,CAAC,CAED,GAAMI,sBAAqB,CAAG,QAAxBA,sBAAqB,CAAIC,UAAe,CAAK,CAClDhB,iBAAiB,CAACgB,UAAU,CAAC,CAC9B,CAAC,CAEA,mBACE,YAAK,SAAS,CAAC,KAAK,uBACtB,KAAC,MAAM,wBACN,MAAC,MAAM,yBACN,KAAC,KAAK,EAAC,IAAI,CAAC,GAAG,CAAC,OAAO,cAAG,KAAC,IAAI,EAAC,OAAO,CAAGjB,cAAgB,CAAC,OAAO,CAAGa,oBAAsB,CAAC,IAAI,CAAGnB,IAAM,EAAK,EAAG,cACjH,KAAC,KAAK,EAAC,IAAI,CAAC,OAAO,CAAC,OAAO,cAAG,KAAC,IAAI,EAAC,OAAO,CAAGM,cAAgB,CAAC,OAAO,CAAGa,oBAAsB,CAAC,IAAI,CAAGnB,IAAM,EAAK,EAAG,GAC7G,EACG,EACL,CAEV,CAEA,cAAeK,IAAG"},"metadata":{},"sourceType":"module","externalDependencies":[]}